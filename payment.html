<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ ‚Äî Free Fire</title>
<style>
body{
    margin:0;
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:url("backgroundphoto2.jpg") no-repeat center/cover;
    font-family:Arial,sans-serif;
    color:white;
}
.container{
    text-align:center;
    background:rgba(0,0,0,0.85);
    padding:30px;
    border-radius:20px;
    box-shadow:0 0 30px rgba(0,0,0,0.7);
    max-width:400px;
    width:100%;
}
h2{color:#FFD700;}
.warning{
    background:#ff0000;
    padding:15px;
    border-radius:12px;
    margin-bottom:20px;
    font-weight:bold;
    animation: blink 1s infinite;
}
@keyframes blink {
    0% { opacity:1; box-shadow:0 0 5px red;}
    50% { opacity:0.6; box-shadow:0 0 25px red;}
    100% { opacity:1; box-shadow:0 0 5px red;}
}
img.qr{
    width:200px;
    margin-bottom:20px;
    border-radius:15px;
}
button{
    padding:12px 30px;
    border:none;
    border-radius:25px;
    cursor:pointer;
    margin:10px;
    font-weight:bold;
}
.pay{
    background:linear-gradient(45deg,#ffcc00,#ff5500);
    color:black;
}
.pay:disabled{
    background:gray;
    cursor:not-allowed;
}
.back{
    background:linear-gradient(45deg,#00BFFF,#007BFF);
    color:white;
}
.history{
    background:#444;
    color:#FFD700;
    font-size:14px;
}
.modal{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.85);
    padding:50px;
}
</style>
</head>

<body>

<div class="container">
    <h2>üí≥ –û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞</h2>

    <div class="warning">
        ‚ùó –í–ê–ñ–ù–û! –£–∫–∞–∂–∏—Ç–µ <u>ID –∏–≥—Ä–æ–∫–∞</u> –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ  
        <br>‚ùå –ë–µ–∑ ID –∑–∞–∫–∞–∑ –ù–ï –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
    </div>

    <img src="QRkode.jpg" class="qr">

    <p>–û–ø–ª–∞—Ç–∏—Ç–µ –∑–∞–∫–∞–∑ –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–∏–∂–µ</p>

    <label>
        <input type="checkbox" id="agreeCheck">
        –Ø –æ–ø–ª–∞—Ç–∏–ª –∏ —É–∫–∞–∑–∞–ª —Å–≤–æ–π ID
    </label>

    <br><br>

    <button class="pay" id="payBtn" disabled>–Ø –æ–ø–ª–∞—Ç–∏–ª</button>
    <button class="back" onclick="goBack()">‚Üê –ù–∞–∑–∞–¥</button>
    <button class="history" id="historyBtn">–ò—Å—Ç–æ—Ä–∏—è</button>
</div>

<div id="historyModal" class="modal">
    <h2>–ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π</h2>
    <div id="historyContent"></div>
    <button onclick="closeHistory()">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>

<script>
// –¢–í–û–ô TELEGRAM BOT
const TOKEN = "–í–ê–®_–¢–û–ö–ï–ù_–ë–û–¢–ê"; // <-- –≤—Å—Ç–∞–≤—å —Å—é–¥–∞ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
const CHAT_ID = "–í–ê–®_CHAT_ID";    // <-- –≤—Å—Ç–∞–≤—å —Å—é–¥–∞ —Å–≤–æ–π chat_id

// –∞–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏
const agreeCheck = document.getElementById("agreeCheck");
const payBtn = document.getElementById("payBtn");

agreeCheck.onchange = () => {
    payBtn.disabled = !agreeCheck.checked;
};

// –∏—Å—Ç–æ—Ä–∏—è
function addPaymentHistory(entry){
    const h = JSON.parse(localStorage.getItem("paymentHistory") || "[]");
    h.push(entry);
    localStorage.setItem("paymentHistory", JSON.stringify(h));
}

document.getElementById("historyBtn").onclick = () => {
    const h = JSON.parse(localStorage.getItem("paymentHistory") || "[]");
    const box = document.getElementById("historyContent");
    box.innerHTML = h.length
        ? h.map(e=>`<p>${e.date} ‚Äî ${e.item}</p>`).join("")
        : "<p>–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</p>";
    document.getElementById("historyModal").style.display="block";
};

function closeHistory(){
    document.getElementById("historyModal").style.display="none";
}

// –æ—Ç–ø—Ä–∞–≤–∫–∞
payBtn.onclick = () => {
    const playerID = localStorage.getItem("playerID");
    const username = localStorage.getItem("username");
    const selectedItemObj = JSON.parse(localStorage.getItem("selectedPackage") || '{}');
    const item = selectedItemObj.name || "–î–æ–Ω–∞—Ç Free Fire";

    if(!playerID || !username){
        alert("‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ: –Ω–∏–∫–Ω–µ–π–º –∏–ª–∏ ID –∏–≥—Ä–æ–∫–∞");
        return;
    }

    const orderId = Date.now();
    const message = 
`üÜï –ù–û–í–´–ô –ó–ê–ö–ê–ó
üÜî –ó–∞–∫–∞–∑: #${orderId}
üë§ –ù–∏–∫: ${username}
üéÆ ID –∏–≥—Ä–æ–∫–∞: ${playerID}
üíé –¢–æ–≤–∞—Ä: ${item}
üí≥ –û–ø–ª–∞—Ç–∞: QR`;

    fetch(`https://api.telegram.org/bot${TOKEN}/sendMessage`, {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body: JSON.stringify({ chat_id: CHAT_ID, text: message })
    })
    .then(res => {
        if(res.ok){
            alert("‚úÖ –ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram");
            addPaymentHistory({item, date: new Date().toLocaleString()});
        } else {
            alert("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ");
        }
    })
    .catch(()=>{
        alert("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ");
    });
};

function goBack(){
    window.location.href="shop.html";
}
</script>

</body>
</html>
